<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Performance</title>
</head>
<body>
  <script>
  function getPerformanceTiming() {
    if (!performance) {
      // å½“å‰æµè§ˆå™¨ä¸æ”¯æŒ
      console.log('ä½ çš„æµè§ˆå™¨ä¸æ”¯æŒ performance æ¥å£');
      return;
    }
    var t = performance.timing;
    var times = {};

    //[é‡è¦]é¡µé¢åŠ è½½å®Œæˆçš„æ—¶é—´  å‡ ä¹ä»£è¡¨äº†ç”¨æˆ·ç­‰å¾…é¡µé¢å¯ç”¨çš„æ—¶é—´
    times.loadPage = t.loadEventEnd - t.navigationStart;
    console.log('é¡µé¢åŠ è½½å®Œæˆçš„æ—¶é—´:'+times.loadPage)

    //[é‡è¦] è§£æDOM æ ‘ç»“æ„çš„æ—¶é—´
    times.domReady = t.domComplete - t.responseEnd;
    console.log('è§£æDOM æ ‘ç»“æ„çš„æ—¶é—´:'+times.domReady)

    //[é‡è¦]é‡å®šå‘çš„æ—¶é—´ æ‹’ç»é‡å®šå‘
    times.redirect = t.redirectEnd - t.redirectStart;
    console.log('é‡å®šå‘çš„æ—¶é—´:'+times.redirect)
    
    //[é‡è¦] DNSæŸ¥è¯¢æ—¶é—´ DNSä¸åŠ è½½åšäº†ä¹ˆï¼Ÿé¡µé¢å†…æ˜¯å¦ä½¿ç”¨äº†å¤ªå¤šä¸åŒçš„åŸŸåå¯¼è‡´åŸŸåæŸ¥è¯¢çš„æ—¶é—´å¤ªé•¿
    // å¯ä½¿ç”¨HTML5 Prefetché¢„æŸ¥è¯¢DNS 
    times.lookupDomain = t.domainLookupEnd - t.domainLookupStart;
    console.log('DNSæŸ¥è¯¢æ—¶é—´:'+times.lookupDomain)

    //[é‡è¦]è¯»å–é¡µé¢ç¬¬ä¸€ä¸ªå­—èŠ‚çš„æ—¶é—´
    // è¿™å¯ä»¥ç†è§£ä¸ºç”¨æˆ·æ‹¿åˆ°ä½ çš„èµ„æºå ç”¨çš„æ—¶é—´ï¼ŒåŠ å¼‚åœ°æœºæˆ¿äº†ä¹ˆï¼ŒåŠ CDNå¤„ç†äº†ä¹ˆï¼Ÿ
    // TTFB å³Time To First Byteçš„æ„æ€
    times.ttfb = t.responseStart - t.navigationStart;
    console.log('è¯»å–é¡µé¢ç¬¬ä¸€ä¸ªå­—èŠ‚çš„æ—¶é—´:'+times.ttfb)

    //[é‡è¦]å†…å®¹åŠ è½½å®Œæˆæ—¶é—´
    // é¡µé¢ç»è¿‡gzipå‹ç¼©äº†ä¹ˆ é™æ€èµ„æºcss jsç­‰å‹ç¼©äº†ä¹ˆ
    times.request = t.responseEnd - t.requestStart;
    console.log('å†…å®¹åŠ è½½å®Œæˆæ—¶é—´:'+times.request)

    //[é‡è¦]æ‰§è¡Œonloadå›è°ƒå‡½æ•°çš„æ—¶é—´
    // æ˜¯å¦å¤ªå¤šä¸å¿…è¦çš„æ“ä½œéƒ½æ”¾åˆ°onloadå›è°ƒå‡½æ•°é‡Œæ‰§è¡Œäº†,è€ƒè™‘è¿‡å»¶è¿ŸåŠ è½½ï¼ŒæŒ‰æ—¶åŠ è½½äº†å—
    times.loadEvent = t.loadEventEnd - t.loadEventStart;
    console.log('æ‰§è¡Œonloadå›è°ƒå‡½æ•°çš„æ—¶é—´:'+times.loadEvent)

    
    //DNSç¼“å­˜æ—¶é—´
    times.appcache = t.domainLookupStart - t.fetchStart;

    // å¸è½½é¡µé¢çš„æ—¶é—´ 
    times.unloadEvent = t.unloadEventEnd - t.unloadEventStart;

    //TCPå»ºç«‹ğŸ”—å®Œæˆæ¡æ‰‹çš„æ—¶é—´
    times.connect = t.connectEnd - t.connectStart;

  }
  </script>
</body>
</html>